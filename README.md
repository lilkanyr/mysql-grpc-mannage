# MySQL 数据库管理系统

这是一个基于 gRPC 和 MySQL Connector/C++ 的数据库管理系统，提供了高性能的数据库连接池和事务管理功能。

## 项目特点

- 基于 gRPC 的客户端-服务器架构
- 高效的 MySQL 连接池管理
- 智能的连接保活机制
- 完整的事务支持
- 中文友好的用户界面
- 强大的错误处理和日志记录

## 系统架构

### 核心组件

1. **连接池管理器 (mysqlDao)**
   - 自动管理数据库连接池
   - 智能的连接保活机制
   - 自动重连和错误恢复
   - 事务支持和查询资源管理

2. **数据库管理器 (mysqlMgr)**
   - 封装数据库操作接口
   - 事务管理
   - 预处理语句支持
   - 自动资源清理

3. **配置管理器 (configMgr)**
   - 集中化配置管理
   - INI 文件支持
   - 运行时配置访问

4. **gRPC 服务 (grpc_server)**
   - 处理客户端请求
   - 操作日志记录
   - 错误处理和状态报告

5. **客户端应用 (grpc_client)**
   - 用户友好的命令行界面
   - 完整的操作菜单
   - 错误处理和状态显示

## 主要功能

- 用户信息管理
  - 插入用户记录
  - 更新用户信息
  - 删除用户记录

## 技术特性

### 连接池管理
- 自动连接池大小管理
- 定期连接保活检查
- 失效连接自动重连
- 连接复用优化

### 事务处理
- ACID 事务支持
- 自动事务回滚
- 预处理语句支持
- 查询资源自动释放

### 错误处理
- 完整的异常捕获
- 详细的错误日志
- 优雅的错误恢复
- 用户友好的错误提示

## 配置说明

配置文件 `config.ini` 包含以下主要设置：

```ini
[mysql]
host=localhost    # 数据库主机地址
port=3306         # 数据库端口
user=root         # 数据库用户名
password=******   # 数据库密码
database=test     # 数据库名称
```

## 构建和运行

### 依赖要求
- CMake 3.10+
- gRPC
- MySQL Connector/C++
- C++17 兼容的编译器

### 构建步骤

```bash
# 创建构建目录
mkdir build
cd build

# 配置项目
cmake ..

# 编译
make
```

### 运行服务

1. 启动服务器：
```bash
./grpc_server
```

2. 运行客户端：
```bash
./grpc_client
```

## 性能优化

- 连接池自动扩缩容
- 预处理语句重用
- 智能的资源管理
- 异步操作支持

## 错误码说明

| 错误类型 | 说明 | 处理方式 |
|---------|------|---------|
| 连接失败 | 无法连接到数据库 | 自动重试，最多3次 |
| 查询超时 | 查询执行超时 | 自动重试或报错 |
| 保活失败 | 连接保活检查失败 | 尝试重新建立连接 |

## 开发团队

- 数据库管理模块开发
- gRPC 服务实现
- 客户端应用开发
- 测试和质量保证

## 更新日志

### 2025-05-14
- 优化连接保活机制
- 增加事务支持
- 改进错误处理
- 添加详细日志记录
